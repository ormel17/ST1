<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Modulo 3 | Documento Bookdown Propuesta</title>
  <meta name="description" content="Bookdown propuesto para la asignatura Series de Tiempo." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Modulo 3 | Documento Bookdown Propuesta" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Bookdown propuesto para la asignatura Series de Tiempo." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Modulo 3 | Documento Bookdown Propuesta" />
  
  <meta name="twitter:description" content="Bookdown propuesto para la asignatura Series de Tiempo." />
  

<meta name="author" content="Diego Fernando Ortiz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modulo-2---unidad-3.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="inicio.html"><a href="inicio.html"><i class="fa fa-check"></i><b>1</b> Inicio</a></li>
<li class="chapter" data-level="2" data-path="modulo-1---unidad-1.html"><a href="modulo-1---unidad-1.html"><i class="fa fa-check"></i><b>2</b> Modulo 1 - Unidad 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modulo-1---unidad-1.html"><a href="modulo-1---unidad-1.html#dataset"><i class="fa fa-check"></i><b>2.1</b> Dataset</a></li>
<li class="chapter" data-level="2.2" data-path="modulo-1---unidad-1.html"><a href="modulo-1---unidad-1.html#resumen-estadístico-de-las-variables"><i class="fa fa-check"></i><b>2.2</b> Resumen Estadístico de las Variables</a></li>
<li class="chapter" data-level="2.3" data-path="modulo-1---unidad-1.html"><a href="modulo-1---unidad-1.html#correlación"><i class="fa fa-check"></i><b>2.3</b> Correlación</a></li>
<li class="chapter" data-level="2.4" data-path="modulo-1---unidad-1.html"><a href="modulo-1---unidad-1.html#análisis-exploratorio-de-datos"><i class="fa fa-check"></i><b>2.4</b> Análisis exploratorio de datos</a></li>
<li class="chapter" data-level="2.5" data-path="modulo-1---unidad-1.html"><a href="modulo-1---unidad-1.html#descomposición-de-series-temporales"><i class="fa fa-check"></i><b>2.5</b> Descomposición de Series Temporales</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modulo-1---unidad-2.html"><a href="modulo-1---unidad-2.html"><i class="fa fa-check"></i><b>3</b> Modulo 1 - Unidad 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modulo-1---unidad-2.html"><a href="modulo-1---unidad-2.html#ajuste-de-los-datos"><i class="fa fa-check"></i><b>3.1</b> Ajuste de los datos</a></li>
<li class="chapter" data-level="3.2" data-path="modulo-1---unidad-2.html"><a href="modulo-1---unidad-2.html#análiis-del-promedio-movil"><i class="fa fa-check"></i><b>3.2</b> Análiis del promedio movil</a></li>
<li class="chapter" data-level="3.3" data-path="modulo-1---unidad-2.html"><a href="modulo-1---unidad-2.html#análisis-de-rezagos"><i class="fa fa-check"></i><b>3.3</b> Análisis de Rezagos</a></li>
<li class="chapter" data-level="3.4" data-path="modulo-1---unidad-2.html"><a href="modulo-1---unidad-2.html#análisis-de-estacionalidad"><i class="fa fa-check"></i><b>3.4</b> Análisis de Estacionalidad</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modulo-1---unidad-3.html"><a href="modulo-1---unidad-3.html"><i class="fa fa-check"></i><b>4</b> Modulo 1 - Unidad 3</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modulo-1---unidad-3.html"><a href="modulo-1---unidad-3.html#análisis-visual-y-descomposición-de-la-serie-temporal"><i class="fa fa-check"></i><b>4.1</b> Análisis Visual y Descomposición de la Serie Temporal</a></li>
<li class="chapter" data-level="4.2" data-path="modulo-1---unidad-3.html"><a href="modulo-1---unidad-3.html#verificación-de-estacionareidad"><i class="fa fa-check"></i><b>4.2</b> Verificación de estacionareidad</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modulo-2---unidad-1.html"><a href="modulo-2---unidad-1.html"><i class="fa fa-check"></i><b>5</b> Modulo 2 - Unidad 1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modulo-2---unidad-1.html"><a href="modulo-2---unidad-1.html#modelo-holt-winters"><i class="fa fa-check"></i><b>5.1</b> Modelo Holt-Winters</a></li>
<li class="chapter" data-level="5.2" data-path="modulo-2---unidad-1.html"><a href="modulo-2---unidad-1.html#aplicación-del-modelo-holt-winters"><i class="fa fa-check"></i><b>5.2</b> Aplicación del modelo Holt-Winters</a></li>
<li class="chapter" data-level="5.3" data-path="modulo-2---unidad-1.html"><a href="modulo-2---unidad-1.html#visualización-de-los-ajustes-del-modelo"><i class="fa fa-check"></i><b>5.3</b> Visualización de los ajustes del modelo</a></li>
<li class="chapter" data-level="5.4" data-path="modulo-2---unidad-1.html"><a href="modulo-2---unidad-1.html#suavizamiento-exponencial"><i class="fa fa-check"></i><b>5.4</b> Suavizamiento exponencial</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modulo-2---unidad-2.html"><a href="modulo-2---unidad-2.html"><i class="fa fa-check"></i><b>6</b> Modulo 2 - Unidad 2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modulo-2---unidad-2.html"><a href="modulo-2---unidad-2.html#modelos-de-series-de-tiempo-definiciones-y-aplicaciones"><i class="fa fa-check"></i><b>6.1</b> Modelos de Series de Tiempo: Definiciones y Aplicaciones</a></li>
<li class="chapter" data-level="6.2" data-path="modulo-2---unidad-2.html"><a href="modulo-2---unidad-2.html#tranformación-y-diferenciación"><i class="fa fa-check"></i><b>6.2</b> Tranformación y Diferenciación</a></li>
<li class="chapter" data-level="6.3" data-path="modulo-2---unidad-2.html"><a href="modulo-2---unidad-2.html#ajuste-del-modelo-lineal-estacionario"><i class="fa fa-check"></i><b>6.3</b> Ajuste del Modelo Lineal Estacionario</a></li>
<li class="chapter" data-level="6.4" data-path="modulo-2---unidad-2.html"><a href="modulo-2---unidad-2.html#diagnóstico-del-modelo"><i class="fa fa-check"></i><b>6.4</b> Diagnóstico del Modelo</a></li>
<li class="chapter" data-level="6.5" data-path="modulo-2---unidad-2.html"><a href="modulo-2---unidad-2.html#previsión-futura"><i class="fa fa-check"></i><b>6.5</b> Previsión Futura</a></li>
<li class="chapter" data-level="6.6" data-path="modulo-2---unidad-2.html"><a href="modulo-2---unidad-2.html#sarima"><i class="fa fa-check"></i><b>6.6</b> SARIMA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modulo-2---unidad-3.html"><a href="modulo-2---unidad-3.html"><i class="fa fa-check"></i><b>7</b> Modulo 2 - Unidad 3</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modulo-2---unidad-3.html"><a href="modulo-2---unidad-3.html#justificación-del-uso-de-prophet"><i class="fa fa-check"></i><b>7.1</b> Justificación del Uso de Prophet</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modulo-3.html"><a href="modulo-3.html"><i class="fa fa-check"></i><b>8</b> Modulo 3</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modulo-3.html"><a href="modulo-3.html#organizar-modelos"><i class="fa fa-check"></i><b>8.1</b> Organizar modelos</a></li>
<li class="chapter" data-level="8.2" data-path="modulo-3.html"><a href="modulo-3.html#red-neuronal-elman"><i class="fa fa-check"></i><b>8.2</b> Red Neuronal Elman</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="modulo-3.html"><a href="modulo-3.html#análisis-de-los-gráficos-de-la-red-elman"><i class="fa fa-check"></i><b>8.2.1</b> Análisis de los Gráficos de la Red Elman</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="modulo-3.html"><a href="modulo-3.html#red-neuronal-jordan"><i class="fa fa-check"></i><b>8.3</b> Red Neuronal Jordan</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="modulo-3.html"><a href="modulo-3.html#análisis-de-los-gráficos-de-la-red-jordan"><i class="fa fa-check"></i><b>8.3.1</b> Análisis de los Gráficos de la Red Jordan</a></li>
<li class="chapter" data-level="8.3.2" data-path="modulo-3.html"><a href="modulo-3.html#comparación-de-redes-elman-y-jordan"><i class="fa fa-check"></i><b>8.3.2</b> Comparación de Redes Elman y Jordan:</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Documento Bookdown Propuesta</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modulo-3" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Modulo 3<a href="modulo-3.html#modulo-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="organizar-modelos" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Organizar modelos<a href="modulo-3.html#organizar-modelos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="modulo-3.html#cb78-1" tabindex="-1"></a><span class="co"># Instalar y cargar librerías necesarias</span></span>
<span id="cb78-2"><a href="modulo-3.html#cb78-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(RSNNS)) <span class="fu">install.packages</span>(<span class="st">&quot;RSNNS&quot;</span>, <span class="at">repos =</span> <span class="st">&quot;http://cran.us.r-project.org&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: RSNNS</code></pre>
<pre><code>## Warning: package &#39;RSNNS&#39; was built under R version 4.2.3</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="modulo-3.html#cb81-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(tidyverse)) <span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>, <span class="at">repos =</span> <span class="st">&quot;http://cran.us.r-project.org&quot;</span>)</span>
<span id="cb81-2"><a href="modulo-3.html#cb81-2" tabindex="-1"></a><span class="fu">library</span>(RSNNS)</span>
<span id="cb81-3"><a href="modulo-3.html#cb81-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb81-4"><a href="modulo-3.html#cb81-4" tabindex="-1"></a></span>
<span id="cb81-5"><a href="modulo-3.html#cb81-5" tabindex="-1"></a><span class="co"># Cargar y preparar datos</span></span>
<span id="cb81-6"><a href="modulo-3.html#cb81-6" tabindex="-1"></a>ruta <span class="ot">&lt;-</span> <span class="st">&quot;C:/Users/Diego Ortiz/OneDrive/Documentos/Series de tiempo/Series1/ST1/DailyDelhiClimateTrain.csv&quot;</span></span>
<span id="cb81-7"><a href="modulo-3.html#cb81-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(ruta) <span class="sc">%&gt;%</span></span>
<span id="cb81-8"><a href="modulo-3.html#cb81-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date),</span>
<span id="cb81-9"><a href="modulo-3.html#cb81-9" tabindex="-1"></a>         <span class="at">log_meantemp =</span> <span class="fu">log</span>(meantemp)) <span class="sc">%&gt;%</span></span>
<span id="cb81-10"><a href="modulo-3.html#cb81-10" tabindex="-1"></a>  <span class="fu">select</span>(date, meantemp, log_meantemp)</span>
<span id="cb81-11"><a href="modulo-3.html#cb81-11" tabindex="-1"></a></span>
<span id="cb81-12"><a href="modulo-3.html#cb81-12" tabindex="-1"></a><span class="co"># Escalar los datos</span></span>
<span id="cb81-13"><a href="modulo-3.html#cb81-13" tabindex="-1"></a>max_value <span class="ot">&lt;-</span> <span class="fu">max</span>(data<span class="sc">$</span>log_meantemp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-14"><a href="modulo-3.html#cb81-14" tabindex="-1"></a>min_value <span class="ot">&lt;-</span> <span class="fu">min</span>(data<span class="sc">$</span>log_meantemp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-15"><a href="modulo-3.html#cb81-15" tabindex="-1"></a>data<span class="sc">$</span>scaled_log_meantemp <span class="ot">&lt;-</span> (data<span class="sc">$</span>log_meantemp <span class="sc">-</span> min_value) <span class="sc">/</span> (max_value <span class="sc">-</span> min_value)</span>
<span id="cb81-16"><a href="modulo-3.html#cb81-16" tabindex="-1"></a></span>
<span id="cb81-17"><a href="modulo-3.html#cb81-17" tabindex="-1"></a><span class="co"># Crear conjuntos de entrenamiento y prueba</span></span>
<span id="cb81-18"><a href="modulo-3.html#cb81-18" tabindex="-1"></a>train_size <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">nrow</span>(data) <span class="sc">*</span> <span class="fl">0.8</span>)</span>
<span id="cb81-19"><a href="modulo-3.html#cb81-19" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data[<span class="dv">1</span><span class="sc">:</span>train_size, ]</span>
<span id="cb81-20"><a href="modulo-3.html#cb81-20" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data[(train_size <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(data), ]</span>
<span id="cb81-21"><a href="modulo-3.html#cb81-21" tabindex="-1"></a></span>
<span id="cb81-22"><a href="modulo-3.html#cb81-22" tabindex="-1"></a><span class="co"># Función para crear secuencias</span></span>
<span id="cb81-23"><a href="modulo-3.html#cb81-23" tabindex="-1"></a>create_sequences <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n_steps) {</span>
<span id="cb81-24"><a href="modulo-3.html#cb81-24" tabindex="-1"></a>  x_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(x) <span class="sc">-</span> n_steps <span class="sc">+</span> <span class="dv">1</span>, <span class="at">ncol =</span> n_steps)</span>
<span id="cb81-25"><a href="modulo-3.html#cb81-25" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(x) <span class="sc">-</span> n_steps <span class="sc">+</span> <span class="dv">1</span>)) {</span>
<span id="cb81-26"><a href="modulo-3.html#cb81-26" tabindex="-1"></a>    x_mat[i,] <span class="ot">&lt;-</span> x[i<span class="sc">:</span>(i <span class="sc">+</span> n_steps <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb81-27"><a href="modulo-3.html#cb81-27" tabindex="-1"></a>  }</span>
<span id="cb81-28"><a href="modulo-3.html#cb81-28" tabindex="-1"></a>  <span class="fu">return</span>(x_mat)</span>
<span id="cb81-29"><a href="modulo-3.html#cb81-29" tabindex="-1"></a>}</span>
<span id="cb81-30"><a href="modulo-3.html#cb81-30" tabindex="-1"></a></span>
<span id="cb81-31"><a href="modulo-3.html#cb81-31" tabindex="-1"></a>n_steps <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb81-32"><a href="modulo-3.html#cb81-32" tabindex="-1"></a>input_train <span class="ot">&lt;-</span> <span class="fu">create_sequences</span>(train_data<span class="sc">$</span>scaled_log_meantemp, n_steps)</span>
<span id="cb81-33"><a href="modulo-3.html#cb81-33" tabindex="-1"></a>output_train <span class="ot">&lt;-</span> train_data<span class="sc">$</span>scaled_log_meantemp[n_steps<span class="sc">:</span><span class="fu">length</span>(train_data<span class="sc">$</span>scaled_log_meantemp)]</span>
<span id="cb81-34"><a href="modulo-3.html#cb81-34" tabindex="-1"></a>input_test <span class="ot">&lt;-</span> <span class="fu">create_sequences</span>(test_data<span class="sc">$</span>scaled_log_meantemp, n_steps)</span>
<span id="cb81-35"><a href="modulo-3.html#cb81-35" tabindex="-1"></a></span>
<span id="cb81-36"><a href="modulo-3.html#cb81-36" tabindex="-1"></a><span class="co"># Función para entrenar, predecir y evaluar modelos</span></span>
<span id="cb81-37"><a href="modulo-3.html#cb81-37" tabindex="-1"></a>train_predict_evaluate <span class="ot">&lt;-</span> <span class="cf">function</span>(model_type, input_train, output_train, input_test) {</span>
<span id="cb81-38"><a href="modulo-3.html#cb81-38" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb81-39"><a href="modulo-3.html#cb81-39" tabindex="-1"></a>  <span class="cf">if</span> (model_type <span class="sc">==</span> <span class="st">&quot;elman&quot;</span>) {</span>
<span id="cb81-40"><a href="modulo-3.html#cb81-40" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">elman</span>(input_train, output_train, <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), <span class="at">learnFuncParams =</span> <span class="fu">c</span>(<span class="fl">0.1</span>), <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">linOut =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-41"><a href="modulo-3.html#cb81-41" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (model_type <span class="sc">==</span> <span class="st">&quot;jordan&quot;</span>) {</span>
<span id="cb81-42"><a href="modulo-3.html#cb81-42" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">jordan</span>(input_train, output_train, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">learnFuncParams =</span> <span class="fu">c</span>(<span class="fl">0.01</span>), <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">linOut =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-43"><a href="modulo-3.html#cb81-43" tabindex="-1"></a>  }</span>
<span id="cb81-44"><a href="modulo-3.html#cb81-44" tabindex="-1"></a>  </span>
<span id="cb81-45"><a href="modulo-3.html#cb81-45" tabindex="-1"></a>  <span class="co"># Gráfico de convergencia del error</span></span>
<span id="cb81-46"><a href="modulo-3.html#cb81-46" tabindex="-1"></a>  <span class="fu">plotIterativeError</span>(model)</span>
<span id="cb81-47"><a href="modulo-3.html#cb81-47" tabindex="-1"></a>  </span>
<span id="cb81-48"><a href="modulo-3.html#cb81-48" tabindex="-1"></a>  predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, input_test)</span>
<span id="cb81-49"><a href="modulo-3.html#cb81-49" tabindex="-1"></a>  predictions <span class="ot">&lt;-</span> predictions <span class="sc">*</span> (max_value <span class="sc">-</span> min_value) <span class="sc">+</span> min_value</span>
<span id="cb81-50"><a href="modulo-3.html#cb81-50" tabindex="-1"></a>  actual_values <span class="ot">&lt;-</span> test_data<span class="sc">$</span>log_meantemp[n_steps<span class="sc">:</span><span class="fu">length</span>(test_data<span class="sc">$</span>log_meantemp)]</span>
<span id="cb81-51"><a href="modulo-3.html#cb81-51" tabindex="-1"></a>  </span>
<span id="cb81-52"><a href="modulo-3.html#cb81-52" tabindex="-1"></a>  rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predictions <span class="sc">-</span> actual_values)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb81-53"><a href="modulo-3.html#cb81-53" tabindex="-1"></a>  mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> actual_values))</span>
<span id="cb81-54"><a href="modulo-3.html#cb81-54" tabindex="-1"></a>  mape <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>((predictions <span class="sc">-</span> actual_values) <span class="sc">/</span> actual_values)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb81-55"><a href="modulo-3.html#cb81-55" tabindex="-1"></a>  </span>
<span id="cb81-56"><a href="modulo-3.html#cb81-56" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">toupper</span>(model_type), <span class="st">&quot;RMSE:&quot;</span>, rmse, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb81-57"><a href="modulo-3.html#cb81-57" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">toupper</span>(model_type), <span class="st">&quot;MAE:&quot;</span>, mae, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb81-58"><a href="modulo-3.html#cb81-58" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">toupper</span>(model_type), <span class="st">&quot;MAPE:&quot;</span>, mape, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb81-59"><a href="modulo-3.html#cb81-59" tabindex="-1"></a>  </span>
<span id="cb81-60"><a href="modulo-3.html#cb81-60" tabindex="-1"></a>  <span class="co"># Visualizar resultados</span></span>
<span id="cb81-61"><a href="modulo-3.html#cb81-61" tabindex="-1"></a>  <span class="fu">plot</span>(test_data<span class="sc">$</span>date[n_steps<span class="sc">:</span><span class="fu">length</span>(test_data<span class="sc">$</span>date)], actual_values, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb81-62"><a href="modulo-3.html#cb81-62" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Predicción con Red&quot;</span>, <span class="fu">toupper</span>(model_type)), <span class="at">xlab =</span> <span class="st">&quot;Fecha&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Temperatura Media Logarítmica&quot;</span>)</span>
<span id="cb81-63"><a href="modulo-3.html#cb81-63" tabindex="-1"></a>  <span class="fu">lines</span>(test_data<span class="sc">$</span>date[n_steps<span class="sc">:</span><span class="fu">length</span>(test_data<span class="sc">$</span>date)], predictions, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb81-64"><a href="modulo-3.html#cb81-64" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Real&quot;</span>, <span class="st">&quot;Predicción&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb81-65"><a href="modulo-3.html#cb81-65" tabindex="-1"></a>  </span>
<span id="cb81-66"><a href="modulo-3.html#cb81-66" tabindex="-1"></a>  <span class="co"># Gráfico de errores</span></span>
<span id="cb81-67"><a href="modulo-3.html#cb81-67" tabindex="-1"></a>  errors <span class="ot">&lt;-</span> predictions <span class="sc">-</span> actual_values</span>
<span id="cb81-68"><a href="modulo-3.html#cb81-68" tabindex="-1"></a>  <span class="fu">plot</span>(test_data<span class="sc">$</span>date[n_steps<span class="sc">:</span><span class="fu">length</span>(test_data<span class="sc">$</span>date)], errors, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb81-69"><a href="modulo-3.html#cb81-69" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Errores de predicción -&quot;</span>, <span class="fu">toupper</span>(model_type)), <span class="at">xlab =</span> <span class="st">&quot;Fecha&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Error&quot;</span>)</span>
<span id="cb81-70"><a href="modulo-3.html#cb81-70" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb81-71"><a href="modulo-3.html#cb81-71" tabindex="-1"></a>  </span>
<span id="cb81-72"><a href="modulo-3.html#cb81-72" tabindex="-1"></a>  <span class="fu">return</span>(model)</span>
<span id="cb81-73"><a href="modulo-3.html#cb81-73" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="red-neuronal-elman" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Red Neuronal Elman<a href="modulo-3.html#red-neuronal-elman" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="modulo-3.html#cb82-1" tabindex="-1"></a>elman_model <span class="ot">&lt;-</span> <span class="fu">train_predict_evaluate</span>(<span class="st">&quot;elman&quot;</span>, input_train, output_train, input_test)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<pre><code>## ELMAN RMSE: 0.004209174 
## ELMAN MAE: 0.00288991 
## ELMAN MAPE: 0.08955447 %</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-44-2.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-44-3.png" width="672" /></p>
<div id="análisis-de-los-gráficos-de-la-red-elman" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Análisis de los Gráficos de la Red Elman<a href="modulo-3.html#análisis-de-los-gráficos-de-la-red-elman" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Gráfico del Error Ponderado (SSE) a lo Largo de las Iteraciones:</strong></li>
</ul>
<p><strong>Descripción:</strong>
Este gráfico muestra cómo se reduce el error ponderado (SSE, Sum of Squared Errors) durante las iteraciones de entrenamiento de la red Elman.</p>
<p><strong>Observaciones:</strong>
El error decrece rápidamente en las primeras iteraciones, lo que indica un aprendizaje rápido inicial.
A partir de aproximadamente la iteración 200, la reducción del error se estabiliza, sugiriendo que el modelo ha alcanzado una convergencia.
El gráfico muestra que la red Elman es capaz de minimizar el error de manera efectiva durante el entrenamiento.</p>
<ul>
<li><strong>Gráfico de Predicción con Red Elman:</strong></li>
</ul>
<p><strong>Descripción:</strong>
Este gráfico compara las predicciones de la red Elman (línea azul) con los valores reales de la temperatura media logarítmica (línea roja) durante el período de prueba.</p>
<p><strong>Observaciones:</strong>
La red Elman sigue de cerca los valores reales, capturando adecuadamente la tendencia y la estacionalidad de los datos.
Hay ligeras desviaciones en algunos picos y valles, pero en general, el ajuste es bastante preciso.
La capacidad de la red Elman para capturar la dinámica temporal es evidente en la similitud entre las líneas de predicción y los valores reales.</p>
<ul>
<li><strong>Gráfico de Errores de Predicción - Elman:</strong></li>
</ul>
<p><strong>Descripción:</strong>
Este gráfico muestra los errores de predicción (diferencia entre las predicciones y los valores reales) a lo largo del período de prueba.</p>
<p><strong>Observaciones:</strong>
Los errores se distribuyen alrededor de cero, lo que indica que no hay un sesgo sistemático en las predicciones.
Los mayores errores se observan al principio del período de prueba, con una tendencia a estabilizarse en torno a cero conforme avanza el tiempo.
La línea roja discontinua en el cero ayuda a visualizar la distribución de los errores, mostrando que los errores positivos y negativos se compensan entre sí.</p>
</div>
</div>
<div id="red-neuronal-jordan" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Red Neuronal Jordan<a href="modulo-3.html#red-neuronal-jordan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="modulo-3.html#cb84-1" tabindex="-1"></a>jordan_model <span class="ot">&lt;-</span> <span class="fu">train_predict_evaluate</span>(<span class="st">&quot;jordan&quot;</span>, input_train, output_train, input_test)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<pre><code>## JORDAN RMSE: 0.01002777 
## JORDAN MAE: 0.007558923 
## JORDAN MAPE: 0.2231786 %</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-45-2.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-45-3.png" width="672" /></p>
<div id="análisis-de-los-gráficos-de-la-red-jordan" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Análisis de los Gráficos de la Red Jordan<a href="modulo-3.html#análisis-de-los-gráficos-de-la-red-jordan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Gráfico del Error Ponderado (SSE) a lo Largo de las Iteraciones:</strong></li>
</ul>
<p><strong>Descripción:</strong>
Similar al gráfico de la red Elman, este gráfico muestra cómo se reduce el error ponderado durante las iteraciones de entrenamiento de la red Jordan.</p>
<p><strong>Observaciones:</strong>
El error decrece rápidamente en las primeras iteraciones, indicando un buen proceso de aprendizaje inicial.
La estabilización del error alrededor de la iteración 200 sugiere que el modelo ha alcanzado la convergencia.
El modelo es eficaz en minimizar el error durante el entrenamiento, similar a la red Elman.</p>
<ul>
<li><strong>Gráfico de Predicción con Red Jordan:</strong></li>
</ul>
<p><strong>Descripción:</strong>
Este gráfico compara las predicciones de la red Jordan (línea azul) con los valores reales de la temperatura media logarítmica (línea roja) durante el período de prueba.</p>
<p><strong>Observaciones:</strong>
La red Jordan también sigue de cerca los valores reales, capturando la tendencia y la estacionalidad.
Las desviaciones en picos y valles son mínimas, mostrando una precisión comparativa a la red Elman.
La red Jordan es igualmente competente en capturar la dinámica temporal de los datos.</p>
<ul>
<li><strong>Gráfico de Errores de Predicción - Jordan:</strong></li>
</ul>
<p><strong>Descripción:</strong>
Este gráfico muestra los errores de predicción de la red Jordan a lo largo del período de prueba.</p>
<p><strong>Observaciones:</strong>
Los errores se distribuyen alrededor de cero, similar al comportamiento observado con la red Elman.
La magnitud de los errores es mayor al inicio del período de prueba, estabilizándose conforme avanza el tiempo.
La distribución de errores alrededor de la línea roja discontinua (cero) indica que no hay un sesgo sistemático en las predicciones.</p>
</div>
<div id="comparación-de-redes-elman-y-jordan" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Comparación de Redes Elman y Jordan:<a href="modulo-3.html#comparación-de-redes-elman-y-jordan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Convergencia y Entrenamiento:</strong></p>
<p>Ambas redes muestran una rápida disminución del error durante las primeras iteraciones y convergen alrededor de la iteración 200.
Ambas redes minimizan el error de manera efectiva durante el entrenamiento.</p>
<p><strong>Precisión de Predicción:</strong></p>
<p>Tanto la red Elman como la red Jordan capturan bien la tendencia y la estacionalidad de los datos.
Las predicciones de ambas redes siguen de cerca los valores reales, con ligeras desviaciones en los picos y valles.</p>
<p><strong>Errores de Predicción:</strong></p>
<p>Los errores de predicción de ambas redes se distribuyen alrededor de cero, sin sesgo sistemático.
Las mayores desviaciones ocurren al inicio del período de prueba, con una tendencia a estabilizarse.</p>
<p><strong>Conclusión:</strong>
Las redes Elman y Jordan son eficaces para la predicción de series temporales, mostrando una precisión y un comportamiento de errores similares. La elección entre una y otra puede depender de la especificidad del problema y las características de los datos.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modulo-2---unidad-3.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
