---
title: "Documento Bookdown Propuesta"
author: "Diego Fernando Ortiz"
date: "Daily Climate time series data"

output: bookdown::gitbook
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
github-repo: rstudio/bookdown-demo
description: "Bookdown propuesto para la asignatura Series de Tiempo."

---

# Inicio

**Fuente:** [Kaggle](https://www.kaggle.com/datasets/sumanthvrao/daily-climate-time-series-data)

* **Relevancia Temática**
Aunque el dataset es específico de Delhi, India, la observación de tendencias y patrones en el comportamiento climático en una región que experimenta variaciones significativas puede proporcionar información valiosa. Estos datos pueden servir como un estudio comparativo para anticipar escenarios posibles en Colombia, especialmente bajo condiciones climáticas extremas similares.

* **Datos Detallados y Granulares**
El conjunto de datos ofrece mediciones diarias desde el 1 de enero de 2013 hasta el 24 de abril de 2017, proporcionando un marco detallado para el análisis de tendencias a largo plazo y variaciones estacionales en Delhi. Esta granularidad facilita el estudio detallado de la relación entre las variaciones de temperatura y otros parámetros climáticos, crucial para entender las dinámicas ambientales que pueden ser similares en otras partes del mundo, incluida Colombia.

* **Aplicabilidad de Análisis Multivariado**
Con variables como temperatura media, humedad, velocidad del viento y presión media, es posible realizar análisis multivariado para investigar cómo las fluctuaciones de estos elementos se correlacionan entre sí y afectan condiciones ambientales más amplias. Esto es relevante para estudiar posibles vínculos entre altas temperaturas y sequías, un fenómeno preocupante también en Colombia.

* **Comparación Interregional**
Mientras que este conjunto de datos es específico de una ciudad, los métodos analíticos aplicados aquí pueden ser extrapolados para comparar diferentes regiones dentro de Colombia, un país con una diversidad climática considerable. Entender cómo diferentes microclimas responden a variaciones similares en parámetros climáticos puede ofrecer insights cruciales para la gestión de recursos y la preparación ante eventos extremos.

* **Soporte para Modelos Predictivos**
Utilizando este conjunto de datos, podemos desarrollar y validar modelos predictivos que estimen el impacto de las variaciones climáticas en los recursos hídricos. Tales modelos no solo son pertinentes para la región de Delhi sino que pueden ser adaptados para prever y mitigar efectos similares en Colombia, especialmente en preparación para futuros eventos climáticos extremos.

# Modulo 1 - Unidad 1 





## Dataset

```{r}
ruta <- "C:/Users/Diego Ortiz/OneDrive/Documentos/Series de tiempo/Series1/ST1/DailyDelhiClimateTrain.csv"


data <- read.csv(ruta)


```



```{r include=FALSE}
# Carga de la biblioteca necesaria
library(tidyverse)
```

Validamos el cargue inicial de nuestro Dataset
```{r}

head(data)
```

## Resumen Estadístico de las Variables
```{r}
summary(data)
```
<br>

* **1. Temperatura Media (meantemp)**

<br>

**Rango:** De 6°C a 38.71°C, mostrando una gran variabilidad anual que es típica de zonas con cambios estacionales marcados.

**Cuartiles:**

**1er Cuartil (Q1):** 18.86°C, indicando que el 25% de los días tienen una temperatura igual o menor a este valor.

**Mediana:** 27.71°C, lo que significa que la mitad de los días son más fríos y la otra mitad más calurosos que este valor.

**3er Cuartil (Q3):** 31.31°C, el 75% de los días tienen temperaturas que no superan este valor.

**Media:** 25.50°C, cercana a la mediana, lo que sugiere una distribución relativamente simétrica de las temperaturas alrededor de este valor central.

<br>

* **2. Humedad**

<br>

**Rango:** De 13.43% a 100%, indicando días con muy baja humedad hasta saturación completa.

**Cuartiles:**

**1er Cuartil (Q1):** 50.38%, el 25% de los días tienen una humedad igual o menor a este valor.

**Mediana:** 62.62%, más de la mitad de los días tienen una humedad superior a este porcentaje.

**Q3:** 72.22%, tres cuartos de los días presentan una humedad que no excede este valor.

**Media:** 60.77%, también cercana a la mediana, sugiriendo una distribución equilibrada de la humedad.

<br>

* **3. Velocidad del Viento**

<br>

**Rango:** De 0 km/h a 42.22 km/h, mostrando días sin viento hasta días con vientos fuertes.

**Cuartiles:**

**Q1:** 3.475 km/h, un cuarto de los días tienen una velocidad de viento igual o menor a este valor.

**Mediana:** 6.222 km/h, indicando que la mitad de los días tienen velocidades de viento menores a este valor.

**Q3:** 9.238 km/h, el 75% de los días tienen velocidades de viento que no superan este valor.

**Media:** 6.802 km/h, ligeramente superior a la mediana, sugiriendo un leve sesgo hacia días con más viento.

<br>

* **4. Presión Media**

<br>

**Rango:** De -3.042 hPa  a 7679.333 hPa.

**Cuartiles:**

**Q1:** 1001.580 hPa, indicando condiciones normales de presión atmosférica.

**Mediana:** 1008.563 hPa, valor medio típico de la presión atmosférica.

**Q3:** 1014.945 hPa, dentro de lo esperado para la presión normal.

**Media:** 1011.105 hPa, cercana a la mediana.
<br>

Verificamos  si hay valores NA
```{r}
sum(is.na(data))
```
No tenemos valores nulos en nuestro Dataset
<br>
<br>

## Correlación





```{R}
# Instalar corrplot si no está instalada
if(!require(corrplot)){
  install.packages("corrplot")
  library(corrplot)
}

# Calcular la matriz de correlación
correlation_matrix <- cor(data[, c("meantemp", "humidity", "wind_speed", "meanpressure")], use = "complete.obs")

# Gráfico de la matriz de correlación
corrplot(correlation_matrix, method = "circle", type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 45, addCoef.col = "black", 
         title = "Matriz de Correlación de Variables Climáticas", cl.cex = 0.8, tl.cex = 0.8)


```

<br>

* **Temperatura Media (meantemp) y Velocidad del Viento (wind_speed):**


**Correlación= 0.31:**  Hay una correlación positiva moderada entre la temperatura media y la velocidad del viento. Esto sugiere que, en general, días más cálidos tienden a estar asociados con vientos más fuertes. Esto podría deberse a que el calor puede intensificar los movimientos del aire debido a diferencias en la presión atmosférica.

<br>

* **Temperatura Media (meantemp) y Humedad (humidity):**

**Correlación= -0.057:** La correlación es muy débil y negativa, indicando que no hay una relación lineal significativa entre la temperatura y la humedad. Los días más cálidos no muestran una tendencia clara de ser más o menos húmedos.

<br>

* **Temperatura Media (meantemp) y Presión Media (meanpressure):**

**Correlación= -0.03:** Similar al caso anterior, hay una correlación negativa muy débil, casi inexistente, entre la temperatura media y la presión media. Esto indica que las variaciones en la temperatura tienen poco o ningún efecto lineal sobre la presión atmosférica en este conjunto de datos.

<br>

* **Velocidad del Viento (wind_speed) y Humedad (humidity):**

**Correlación= -0.37:**  Existe una correlación negativa moderada entre la velocidad del viento y la humedad. Esto puede sugerir que días con vientos más fuertes tienden a tener menor humedad, posiblemente porque el viento dispersa la humedad del aire.

<br>

* **Velocidad del Viento (wind_speed) y Presión Media (meanpressure):**

**Correlación= -0.02:** Hay una correlación negativa muy baja entre la velocidad del viento y la presión media, lo que sugiere que no hay una relación lineal clara entre estas dos variables.

<br>

* **Humedad (humidity) y Presión Media (meanpressure):**

**Correlación= 0:** No existe correlación entre la humedad y la presión media, indicando que los cambios en una no están linealmente relacionados con cambios en la otra en este conjunto de datos.


## Análisis exploratorio de datos

**Distribuciones individuales**

<br>

**Temperatura Media**



```{r}
# Histograma de la temperatura media
ggplot(data, aes(x = meantemp)) +
  geom_histogram(bins = 30, fill = "blue", color = "black") +
  labs(title = "Distribución de la Temperatura Media", x = "Temperatura Media", y = "Frecuencia")
```
El histograma de la temperatura media muestra una distribución bimodal, con dos picos claramente definidos. Esto sugiere patrones estacionales, con temperaturas más bajas en los meses de invierno y más altas en los meses de verano. La distribución relativamente amplia indica variabilidad en las temperaturas diarias a lo largo del año.

<br>

**Humedad**

<br>

```{r}
# Histograma de la humedad
ggplot(data, aes(x = humidity)) +
  geom_histogram(bins = 30, fill = "green", color = "black") +
  labs(title = "Distribución de la Humedad", x = "Humedad", y = "Frecuencia")
```
La distribución de la humedad parece ser ligeramente sesgada hacia la derecha, con un rango que cubre desde muy baja hasta saturación (100%). La mayoría de los valores se concentra alrededor del 50-80%, indicando una humedad generalmente alta en esta área.

<br>

**Velocidad del viento**

```{r}
# Histograma de la velocidad del viento
ggplot(data, aes(x = wind_speed)) +
  geom_histogram(bins = 30, fill = "red", color = "black") +
  labs(title = "Distribución de la Velocidad del Viento", x = "Velocidad del Viento", y = "Frecuencia")


```
El histograma para la velocidad del viento muestra una distribución sesgada hacia la derecha, con la mayoría de los días teniendo velocidades bajas a moderadas y unos pocos días con velocidades extremadamente altas. Esto es típico en áreas donde los días de viento extremo son menos frecuentes pero pueden alcanzar velocidades significativas.

## Descomposición de Series Temporales

```{r}
# Asegurándose de que la columna de fecha es de tipo Date
data$date <- as.Date(data$date)

# Cargar ggplot2 para gráficos
library(ggplot2)
```

<br>
**Temperatura Media**

```{r}

ggplot(data, aes(x = date, y = meantemp)) +
  geom_line(group=1, colour="blue") +
  labs(title="Serie Temporal de la Temperatura Media", x="Fecha", y="Temperatura Media (°C)")
```
El gráfico de la serie temporal de la temperatura media muestra una clara estacionalidad con temperaturas que oscilan regularmente cada año, sin una tendencia general evidente de aumento o disminución a lo largo del tiempo. Las variaciones estacionales son prominentes, con picos durante los meses de verano y valles en los meses de invierno, reflejando la típica fluctuación climática de la región. La variabilidad interanual en la amplitud de estas oscilaciones sugiere diferencias en la intensidad de las estaciones que podrían estar influenciadas por factores climáticos adicionales. No se observan tendencias a largo plazo en el aumento o disminución de las temperaturas medias anuales, lo que indica una relativa estabilidad en el clima durante el período observado.

<br>
**Humeda**

```{r}

ggplot(data, aes(x = date, y = humidity)) +
  geom_line(group=1, colour="green") +
  labs(title="Serie Temporal de la Humedad", x="Fecha", y="Humedad (%)")
```

El gráfico de la serie temporal de la humedad muestra una estacionalidad marcada, con oscilaciones claras y repetidas que indican variaciones significativas entre períodos húmedos y secos a lo largo del año. Las diferencias anuales en la altura de los picos sugieren variabilidad en la intensidad de las estaciones lluviosas, probablemente relacionadas con cambios en los patrones climáticos locales. Los períodos de alta humedad, que a menudo alcanzan el 100%, podrían corresponder a las temporadas de monzones, mientras que los valles representan los tiempos más secos, destacando la influencia de los ciclos estacionales en el clima de la región.

<br>
**Velocidad del Viento**

```{r}
ggplot(data, aes(x = date, y = wind_speed)) +
  geom_line(group=1, colour="red") +
  labs(title="Serie Temporal de la Velocidad del Viento", x="Fecha", y="Velocidad del Viento (km/h)")
```
El gráfico muestra la velocidad del viento a lo largo de varios años, destacando variaciones diarias significativas sin una tendencia clara de aumento o disminución a largo plazo. La velocidad del viento presenta una estacionalidad menos marcada comparada con la temperatura y la humedad, aunque se observan picos ocasionales que podrían corresponder a eventos meteorológicos específicos como tormentas o frentes de alta velocidad. Estos picos son notables y esporádicos, con la mayoría de los valores concentrados en rangos más bajos, indicando que días con vientos extremadamente fuertes son menos frecuentes. La serie muestra una variabilidad considerable día a día, lo cual es típico en los registros de velocidad del viento debido a su naturaleza altamente dinámica y susceptible a cambios rápidos debido a las condiciones locales y regionales.



# Modulo 1 - Unidad 2

## Ajuste de los datos

Ajustamos el formato fecha


```{r}
# Imprimir las primeras fechas para verificar el formato
print(head(data$date))
```


```{r}

library(tidyverse)  
library(lubridate)  


# Convertir la columna de fecha a formato de fecha usando ymd()
data$date <- ymd(data$date)

# Validar primeros registros
head(data)

# Ver structura de los datos para asegurar que las transformaciones son correctas
str(data)


```

## Análiis del promedio movil

```{r}


# Cargar la biblioteca para el cálculo de medias móviles
library(zoo)

# Calcular el promedio móvil de 30 días para la temperatura media
data$MovingAvg <- rollmean(data$meantemp, 30, fill = NA, align = "center")

# Utilizar ggplot2 para visualizar la temperatura media y su promedio móvil
library(ggplot2)
ggplot(data, aes(x = date)) +
  geom_line(aes(y = meantemp), color = "blue", size = 1, alpha = 0.5) +
  geom_line(aes(y = MovingAvg), color = "red", size = 1) +
  labs(title = "Temperatura Media y Promedio Móvil de 30 días",
       x = "Fecha", y = "Temperatura (°C)") +
  theme_minimal()

```
El gráfico muestra claramente las tendencias subyacentes y suaviza las fluctuaciones diarias, resaltando la estacionalidad marcada en la serie de tiempo. La línea roja del promedio móvil sigue de cerca los picos y valles del gráfico de temperatura original (azul), pero con menos ruido, facilitando la identificación de los períodos más cálidos y fríos del año. Esta suavización ayuda a visualizar la tendencia central de la temperatura a lo largo del tiempo, lo cual es especialmente útil para analizar patrones estacionales y para detectar anomalías o cambios inusuales en el clima que podrían no ser evidentes en los datos diarios.

## Análisis de Rezagos

```{r}


# Crear rezagos de la temperatura media
data$lag1 <- lag(data$meantemp, 1)  # Rezago de un día
data$lag7 <- lag(data$meantemp, 7)  # Rezago de una semana

# Visualización de la temperatura con rezagos
ggplot(data, aes(x = date)) +
  geom_line(aes(y = meantemp, color = "Temperatura actual"), size = 1) +
  geom_line(aes(y = lag1, color = "Rezago 1 día"), size = 1, linetype = "dashed") +
  geom_line(aes(y = lag7, color = "Rezago 7 días"), size = 1, linetype = "dotted") +
  labs(title = "Temperatura Media y Rezagos",
       x = "Fecha", y = "Temperatura (°C)") +
  scale_color_manual(values = c("Temperatura actual" = "blue", "Rezago 1 día" = "green", "Rezago 7 días" = "red")) +
  theme_minimal()


```
El gráfico de la temperatura media junto con sus rezagos de 1 día y 7 días ilustra cómo las temperaturas pasadas están estrechamente relacionadas con los valores actuales, lo que sugiere una fuerte autocorrelación diaria y semanal en la serie temporal. La superposición de las líneas de rezago con la temperatura actual muestra que los patrones diarios y semanales son consistentes a lo largo del tiempo, con los rezagos siguiendo muy de cerca la serie principal, especialmente el rezago de un día.

Esto refleja que las temperaturas de días anteriores pueden ser buenos predictores de la temperatura del día siguiente, evidenciando dependencia temporal significativa. Los rezagos de una semana, aunque también siguen de cerca la tendencia principal, muestran una variación ligeramente mayor, indicando que mientras la influencia de los valores pasados persiste a lo largo de la semana, los factores externos o variaciones naturales pueden influir más en la variabilidad a medida que aumenta el intervalo de rezago.


**Correlación Rezagos**

* **Rezago 1 Día**

```{r}
cor(data$meantemp, data$lag1, use = "complete.obs")  # Correlación con rezago de un día
```
La correlación entre la temperatura y sus rezagos revela una conexión notablemente fuerte tanto a corto como a mediano plazo. La correlación de 0.974 para el rezago de un día indica que la temperatura de un día específico es casi perfectamente predictiva de la temperatura del día siguiente, reflejando una alta dependencia diaria. Esto es común en variables climáticas como la temperatura, donde las condiciones de un día tienden a ser similares al siguiente, a menos que ocurran cambios meteorológicos significativos.
<br>
* **Rezago 7 Día**

```{r}
cor(data$meantemp, data$lag7, use = "complete.obs")  # Correlación con rezago de siete días

```
La correlación de 0.916 para el rezago de siete días sigue siendo muy alta, lo que sugiere que la temperatura también tiene una fuerte memoria semanal. Aunque la influencia se atenúa ligeramente con el tiempo, el valor sigue siendo lo suficientemente alto como para indicar que la temperatura de una semana puede predecir bastante bien la temperatura de la semana siguiente. Esto puede ser útil para pronósticos a corto plazo, ya que muestra que las temperaturas tienden a mantenerse relativamente estables o seguir patrones predecibles a lo largo de una semana.

## Análisis de Estacionalidad

**Análisis estacional**

```{r}

# Extraer el mes de cada fecha para análisis estacional
data$month <- month(data$date)

# Calcular la media mensual de la temperatura
monthly_avg <- data %>%
  group_by(month) %>%
  summarise(mean_temp = mean(meantemp, na.rm = TRUE))

# Ordenar los resultados por mes para correcta visualización
monthly_avg <- monthly_avg %>%
  arrange(month)

# Visualizar la estacionalidad de la temperatura media
ggplot(monthly_avg, aes(x = month, y = mean_temp)) +
  geom_line(group = 1, color = "blue") +
  geom_point(color = "red") +
  scale_x_continuous(breaks = 1:12, labels = c("Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic")) +
  labs(title = "Estacionalidad de la Temperatura Media por Mes",
       x = "Mes", y = "Temperatura Media (°C)") +
  theme_minimal()


```

El gráfico que muestra la estacionalidad de la temperatura media por mes en Delhi ilustra claramente el patrón estacional típico en la región. Se observa un aumento pronunciado en las temperaturas desde enero, alcanzando su punto máximo en los meses de verano de mayo a julio, donde las temperaturas se mantienen en valores altos. Posteriormente, las temperaturas comienzan a disminuir gradualmente hacia el final del año.

Este patrón refleja las características climáticas de un clima subtropical, donde los veranos son calurosos y los inviernos relativamente fríos. La gráfica destaca los meses más cálidos claramente, lo que puede ser crucial para la planificación en sectores como la agricultura, la salud pública y la gestión de recursos energéticos, ya que estos meses pueden requerir medidas adicionales debido al calor extremo. Además, el marcado descenso hacia finales de año sugiere que las condiciones se vuelven considerablemente más frescas, lo que también podría tener implicaciones significativas en varias actividades y servicios.

**Descomposición estacional**

```{r}
# Usar la función stl() para descomposición estacional
data_ts <- ts(data$meantemp, frequency = 12)  # Asumiendo datos mensuales
result_stl <- stl(data_ts, s.window = "periodic")

# Visualizar los componentes de la descomposición
plot(result_stl)


```
**Análisis de los Componentes:**
<br>

* **Componente de Datos:**
Muestra la serie temporal original de la temperatura media. Esta visualización es útil para comparar directamente con los componentes extraídos y ver cómo se componen los datos originales.

* **Componente Estacional:**
Claramente visible, este componente captura la variabilidad estacional de la serie, mostrando patrones repetitivos que corresponden a las fluctuaciones estacionales anuales. Este patrón estacional es muy regular, indicando fuertes variaciones estacionales que son típicas en los datos climáticos, donde las temperaturas cambian según la estación.

* **Componente de Tendencia:**
Este gráfico muestra la tendencia subyacente en los datos, eliminando los efectos de la estacionalidad y otros ruidos. Observamos un movimiento suave que revela los cambios a largo plazo en la temperatura, como un aumento o disminución gradual. Esto es crucial para comprender las tendencias climáticas a lo largo del tiempo, incluyendo el calentamiento o enfriamiento en la región de estudio.

* **Componente de Residuo:**
Los residuos representan lo que queda después de extraer los componentes de tendencia y estacionalidad. Estos pueden incluir efectos aleatorios y anomalías no capturadas por los modelos de estacionalidad y tendencia. El gráfico de residuos parece ser bastante "ruidoso", lo cual es típico, indicando que hay variaciones en los datos que no se ajustan a patrones estacionales simples o tendencias suaves.

# Modulo 1 - Unidad 3


## Análisis Visual y Descomposición de la Serie Temporal

<br>

**Visualización inicial**

Utilizamos gráficos de líneas para obtener una vista preliminar de los datos. Esto  ayudará a identificar visualmente tendencias y ciclos.

```{r}
ggplot(data, aes(x = date, y = meantemp)) +
  geom_line() +
  labs(title = "Tendencia de la Temperatura Media", x = "Fecha", y = "Temperatura Media")

```
La visualización inicial de la tendencia de la temperatura media  muestra la variabilidad y los patrones estacionales a lo largo del tiempo. Este gráfico ilustra la oscilación de las temperaturas a través de las estaciones, con picos durante los meses de verano y valles en los meses de invierno, lo que indica una fuerte estacionalidad en los datos. Además, la serie muestra fluctuaciones dentro de cada temporada que podrían estar influenciadas por factores meteorológicos adicionales.

* Estacionalidad: 
Los picos y valles recurrentes a lo largo de los años demuestran la influencia de las estaciones en la temperatura media. Esto es típico de las regiones que experimentan variaciones climáticas significativas a lo largo del año.

* Variabilidad: 
La variabilidad en las temperaturas también puede sugerir la influencia de fenómenos climáticos más cortos como olas de calor o frentes fríos.

**Descomposición**

```{r}
library(forecast)  


ts_data <- ts(data$meantemp, frequency = 365)  # Ajusta la frecuencia 

# Aplicar STL
result_stl <- stl(ts_data, s.window = "periodic")  

plot(result_stl)


```
**Componente de Datos:** La gráfica superior muestra la serie temporal original, que es crucial para visualizar cómo la temperatura fluctúa a lo largo del tiempo.

**Componente Estacional:** Este componente destaca la estacionalidad regular y predecible en la serie temporal, reflejando los patrones estacionales típicos que se repiten anualmente. Es vital para comprender cómo las temperaturas cambian con las estaciones.

**Componente de Tendencia:** La tendencia muestra un incremento gradual a lo largo del tiempo, sugiriendo un aumento en las temperaturas medias que podría ser de interés para estudios sobre el clima y el medio ambiente. Esta tendencia ascendente podría indicar un calentamiento a largo plazo en la región estudiada.

**Componente de Residuo:** Los residuos representan la variabilidad aleatoria que no es explicada por los patrones estacionales ni por la tendencia. Estos son relativamente pequeños y aleatorios, lo que sugiere que los componentes de estacionalidad y tendencia están capturando bien las dinámicas principales de la serie temporal.


## Verificación de estacionareidad

Determinamos si la serie temporal es estacionaria

**Prueba de Dickey-Fuller Aumentada (ADF):**
Una prueba estadística para verificar la presencia de una raíz unitaria, indicativo de no estacionariedad.

```{r}
library(tseries)
adf.test(data$meantemp, alternative = "stationary")

```
**Análisis Resultados:**

**Dickey-Fuller =** -1.8526: Este valor por sí solo no es suficiente para rechazar la hipótesis nula sin considerar el p-valor asociado.

**p-valor = 0.6407:** Al ser un p-valor alto, confirma que la serie temporal tiene una tendencia estocástica o una raíz unitaria, indicando que la serie es no estacionaria.

**Implicaciones de la No Estacionariedad**

La no estacionariedad en la serie temporal puede presentar desafíos significativos para el análisis y la predicción porque los modelos estadísticos y de machine learning que asumen estacionariedad pueden dar resultados engañosos o inexactos cuando se aplican a datos no estacionarios, ademas la variabilidad en la media y la varianza a lo largo del tiempo puede afectar la precisión de las predicciones a largo plazo.



Para abordar la no estacionariedad y hacer la serie temporal adecuada para análisis y modelado predictivonos vemos en la necesidad de aplicar transformaciones a la serie temporal de la temperatura media para controlar la tendencia y la variabilidad.

**Transformación Logarítmica y Visualización**

```{r transform-and-plot-log}
# Transformación Logarítmica
data$log_meantemp <- log(data$meantemp)

# Visualización de la serie logarítmica
ggplot(data, aes(x = date, y = log_meantemp)) +
  geom_line() +
  labs(title = "Logaritmo de la Temperatura Media", x = "Fecha", y = "Log(Temperatura Media)")
```

**Diferenciación y Visualización**

```{r}
# Calcular la diferenciación logarítmica y eliminar la primera fila para mantener la consistencia de datos
diff_series <- diff(data$log_meantemp)
data <- data[-1, ]  # Elimina la primera fila
data$diff_log_meantemp <- diff_series

# Visualización de la serie diferenciada
ggplot(data, aes(x = date, y = diff_log_meantemp)) +
  geom_line() +
  labs(title = "Diferencia del Logaritmo de la Temperatura Media", x = "Fecha", y = "Diferencia de Log(Temperatura Media)")

```

**Reevaluar la Estacionariedad**

```{r}
# Prueba ADF en la serie transformada y diferenciada
adf_result_transformed <- adf.test(data$diff_log_meantemp, alternative = "stationary")
print(adf_result_transformed)

```

**Resultados de la Prueba ADF**

**Dickey-Fuller = -13.915:** Este valor es mucho más negativo que en la prueba anterior sin diferenciar, lo que indica una fuerte evidencia en contra de la hipótesis nula de presencia de una raíz unitaria.
**p-valor = 0.01:** Este p-valor es significativamente bajo y sugiere que la hipótesis nula de no estacionariedad puede ser rechazada con un nivel de confianza del 99%.


El p-valor bajo y el valor crítico altamente negativo implican que la serie diferenciada y logarítmicamente transformada de la temperatura media ahora es estacionaria. Esto significa que la serie no presenta tendencias o patrones estacionales que dependan del tiempo, lo cual es crucial para el análisis de series temporales y el modelado predictivo.




# Modulo 2 - Unidad 1

## Modelo Holt-Winters

**Holt-Winters:** Es un método de suavizado exponencial que es especialmente útil para datos con tendencias y estacionalidad. Holt-Winters puede aplicar suavizado tanto a la tendencia como a la componente estacional de la serie, haciendo que sea una opción robusta para prever futuros valores en series que exhiben patrones estacionales claros.

## Aplicación del modelo Holt-Winters

```{r}
# Asegurarse de que los datos están en formato de serie temporal
ts_data <- ts(data$meantemp, frequency = 365)

# Aplicar el modelo Holt-Winters
hw_model <- HoltWinters(ts_data)

# Ver los componentes del modelo
hw_model

```
<br>

**Aplicación del Modelo Holt-Winters a la Serie Temporal de Temperatura Media**

En esta sección del análisis, he aplicado el modelo de suavizado exponencial Holt-Winters a la serie temporal de temperatura media para capturar tanto la tendencia como la estacionalidad inherentes a los datos. El modelo Holt-Winters es particularmente adecuado para datos con patrones estacionales y tendencias, lo cual es característico de las series temporales climáticas.

**Configuración del Modelo**

El modelo se configuró con los siguientes parámetros de suavizado:

* **Alpha (α) = 0.712403:** Este parámetro controla el nivel de suavizado de la serie y está configurado para adaptarse rápidamente a los cambios en el nivel de los datos.

* **Beta (β) = 0:** Decidí no aplicar suavizado adicional a la tendencia de la serie, ya que los datos han mostrado una tendencia relativamente estable a lo largo del tiempo.

* **Gamma (γ) = 1:** Este parámetro está configurado para permitir una adaptación completa y rápida a los cambios estacionales, esencial para manejar la significativa variabilidad estacional observada en los datos de temperatura.

<br>

**Resultados del Modelo**

El modelo Holt-Winters se ajustó a los datos con los siguientes componentes resultantes:

* **Nivel (a):** El nivel estimado al final del período modelado es aproximadamente 23.2, indicando el punto de partida ajustado para la temperatura media.

* **Tendencia (b):** La tendencia estimada es muy pequeña (aproximadamente 0.000787), lo que sugiere cambios mínimos en la tendencia de la temperatura a lo largo del tiempo.

* **Componentes Estacionales (s1 a s365):** Estos coeficientes reflejan las variaciones estacionales diarias a lo largo del año, ajustando la predicción para cada día específico en base a patrones estacionales pasados.

<br>

* **Justificación del Modelo**

La elección del modelo Holt-Winters se justifica por la clara presencia de una estacionalidad y una tendencia en la serie temporal. Dado que la temperatura media varía a lo largo del año y muestra una tendencia general mínima pero estable, este modelo proporciona una herramienta robusta para hacer predicciones futuras. La capacidad del modelo para ajustar y adaptarse tanto a la tendencia como a la estacionalidad es crucial para prever con precisión en contextos donde los patrones estacionales son significativos y donde la tendencia puede ser sutil pero importante a largo plazo.

* **Visualización y Evaluación**

Para evaluar la efectividad del modelo, visualicé los ajustes del modelo en comparación con los datos observados. Esta visualización ayuda a confirmar que el modelo capta adecuadamente tanto la tendencia general como los patrones estacionales. Además, planeo calcular métricas de error como el RMSE para cuantificar objetivamente la precisión del modelo.


## Visualización de los ajustes del modelo

```{r}
# Visualizar los ajustes
plot(hw_model, main="Ajuste del Modelo Holt-Winters a la Temperatura Media")

```

<br>

**Análisis del Modelo Holt-Winters en la Temperatura Media**

Como se puede ver en la gráfica, tenemos nuestros datos observados en negro y las estimaciones del modelo en rojo.

**Lo que Podemos Ver del Modelo**

* **Seguimiento de los Patrones:** El modelo hace un gran trabajo siguiendo los altibajos de los datos reales. Esto  muestra que el modelo puede capturar bien tanto la tendencia como los patrones estacionales de la temperatura.

* **Respuesta Rápida:** El modelo se adapta rápidamente a los cambios bruscos. Esto es crucial, especialmente cuando estamos tratando con variables climáticas que pueden cambiar rápidamente.

## Suavizamiento exponencial

```{r}
# Aplicar suavizamiento exponencial simple
smoothed_data <- HoltWinters(ts_data, beta=FALSE, gamma=FALSE)

# Visualización de la serie suavizada
plot(smoothed_data$fitted, main="Suavizado Exponencial de la Temperatura Media")

```

**Suavizado Exponencial de la Temperatura Media**

La gráfica muestra el resultado del suavizado exponencial aplicado a la serie temporal de la temperatura media. Este método ha sido implementado utilizando el modelo Holt-Winters con parámetros específicos para minimizar la influencia de la tendencia y la estacionalidad en el suavizado.

**Características del Suavizado**

* **Nivel Único de Suavizado:** Al configurar beta=FALSE y gamma=FALSE, el modelo se centra exclusivamente en el suavizado del nivel de la serie. Esto resulta en una serie más suave que refleja las variaciones generales de la temperatura sin ajustarse a las fluctuaciones estacionales o de tendencia específicas.

* **Comparación de Niveles:** La gráfica superior muestra la serie temporal original con las estimaciones de nivel superpuestas, proporcionando una visión clara de cómo el suavizado alinea los datos a lo largo del tiempo. La gráfica inferior muestra estos niveles de forma más aislada, destacando la suavidad de la serie resultante.

**Justificación del Método**

El uso de suavizado exponencial simple en este contexto se justifica por la necesidad de obtener una visión más general de la tendencia central de la temperatura sin las fluctuaciones menores que podrían ocultar patrones más amplios. Este enfoque es particularmente útil para:

* **Análisis a Largo Plazo:** Facilitar la identificación de cambios a largo plazo en la temperatura media, útil para estudios climáticos y planificación ambiental.

* **Reducción de Ruido:** Minimizar el impacto de variaciones estacionales y otros ruidos, haciendo que la serie sea más manejable para análisis que no requieren una granularidad fina.

**Evaluación y Observaciones**

La evaluación visual sugiere que el suavizado ha sido efectivo para proporcionar una representación clara y continua de la tendencia central de los datos. Sin embargo, es importante considerar que este método puede ocultar detalles importantes necesarios para algunos tipos de análisis específicos. Por ello, se recomienda usar este enfoque cuando se busque una perspectiva general y no se necesiten detalles de fluctuaciones a corto plazo.




# Modulo 2 - Unidad 2


* **Inclusión de Variables en el Tiempo ** 

```{r}
library(lubridate)  # para manejo de fechas

# Convertir la columna de fecha a tipo Date si no está convertida
data$date <- as.Date(data$date)

# Crear nuevas variables de tiempo
data$year <- year(data$date)
data$month <- month(data$date)
data$day <- day(data$date)
data$day_of_week <- wday(data$date, label = TRUE)  # Días de la semana con etiquetas

```












## Modelos de Series de Tiempo: Definiciones y Aplicaciones

* **Modelo Autorregresivo (AR):**
Un modelo AR utiliza dependencias entre observaciones sucesivas para predecir valores futuros basándose únicamente en los valores pasados. Se denota como AR(p), donde 'p' es el número de observaciones pasadas (lags) utilizadas como predictores.

* **Modelo de Media Móvil (MA):**
En un modelo MA, la predicción se realiza sobre la base de los errores de predicción pasados, no directamente sobre los valores. Se expresa como MA(q), donde 'q' es el número de errores pasados que el modelo toma en cuenta.

* **Modelo ARIMA (AutoRegressive Integrated Moving Average):**
Combinando AR y MA, este modelo también incorpora un término de diferenciación (d) para convertir la serie en estacionaria, esencial para cumplir con los supuestos de los modelos lineales de series de tiempo. Se denota como ARIMA(p, d, q).

* **Modelo ARIMA Estacional:**
Extiende el ARIMA para capturar estacionalidades. Se denota como ARIMA(p, d, q)(P, D, Q)[s], donde P, D, y Q representan la autoregresión estacional, la diferenciación estacional, y la media móvil estacional, respectivamente, con 's' indicando la periodicidad de la temporada.


**Ajuste de Modelos de Series de Tiempo en R**

*
```{r}
# Cargar las librerías necesarias
library(tseries)
library(forecast)
library(ggplot2)
library(lubridate)

# Cargar el dataset
ruta <- "C:/Users/Diego Ortiz/OneDrive/Documentos/Series de tiempo/Series1/ST1/DailyDelhiClimateTrain.csv"
data <- read.csv(ruta)

# Ajuste del formato de la fecha
data$date <- as.Date(data$date)
data$day_of_week <- wday(data$date, label = TRUE)

# Crear nuevas variables temporales
data$year <- year(data$date)
data$month <- month(data$date)
data$day <- day(data$date)

# Análisis de Estacionariedad y Transformaciones
# Verificación inicial de estacionariedad
adf_result_original <- adf.test(data$meantemp, alternative = "stationary")
print(adf_result_original)
```

* **Estadístico de Dickey-Fuller: -1.8526**

Este valor es el estadístico de la prueba de Dickey-Fuller. Valores más negativos indican una mayor evidencia contra la hipótesis nula de no estacionariedad.

* **Orden de Rezago: 11 **

Indica el número de retardos utilizados en la prueba. Un valor de 11 sugiere que la prueba tomó en cuenta 11 términos de rezago para corregir la autocorrelación en la serie.

* **+*p-valor: 0.6407**

El p-valor asociado con esta prueba es 0.6407. Un p-valor alto (mayor que 0.05) indica que no podemos rechazar la hipótesis nula de que la serie tiene una raíz unitaria (es decir, la serie no es estacionaria).

Con base en los resultados de la prueba ADF, podemos concluir que la serie de temperatura media no es estacionaria, ya que el p-valor es significativamente mayor que 0.05. Esto implica que hay una tendencia o patrones cíclicos en la serie que deben ser tratados antes de proceder con el modelado de series temporales.

## Tranformación y Diferenciación

```{r}
# Transformación logarítmica
data$meantemp_log <- log(data$meantemp)

# Diferenciación de la serie transformada
data$meantemp_diff <- c(NA, diff(data$meantemp_log))  # Agrega NA al inicio para mantener la longitud

# Reevaluar estacionariedad con la serie diferenciada
adf_result_diff <- adf.test(na.omit(data$meantemp_diff), alternative = "stationary")
print(adf_result_diff)

```

** Interpretación de los Resultados**

* **Estadístico de Dickey-Fuller: -13.915**

Este valor es mucho más negativo en comparación con el valor original de -1.8526, lo que sugiere una fuerte evidencia en contra de la hipótesis nula de no estacionariedad.

* **Orden de Rezago: 11**

Al igual que en la prueba anterior, este valor indica el número de términos de rezago utilizados en la prueba para corregir la autocorrelación.

* **p-valor: 0.01**

El p-valor asociado es 0.01, lo que es significativamente menor que 0.05. Esto nos permite rechazar la hipótesis nula de no estacionariedad con un nivel de confianza del 99%.
Conclusión

Con base en estos resultados, podemos concluir que la serie diferenciada y transformada de la temperatura media es estacionaria, podemos proceder con el ajuste de un modelo de series temporales.

## Ajuste del Modelo Lineal Estacionario

```{r}
# Remover NA creado por la diferenciación
data <- na.omit(data)

# Ajuste de un Modelo Lineal Estacionario
# Modelo lineal utilizando variables temporales y la serie transformada y diferenciada
model <- lm(meantemp_diff ~ year + month + day_of_week, data = data)

# Revisar el resumen del modelo para ver la significancia de los predictores
summary(model)
```

**Análisis de los Resultados:**

**Coeficientes:**

* **Intercepto:** No es significativo con un valor p de 0.65942.
* **Año (year):** No es significativo con un valor p de 0.66144.
* **Mes (month):** Significativo con un valor p de 0.00796. Esto sugiere que la diferencia logarítmica de la temperatura media tiene una relación significativa con el mes del año.
* **Día de la Semana (day_of_week):** Ninguno de los componentes del polinomio ortogonal es significativo individualmente.


**Errores Residuales:**

* **Residual estándar:** 0.07531
* **Mínimo:** -0.40903
* **1er Cuartil:** -0.03496
* **Mediana:** 0.00410
* **3er Cuartil:** 0.03966
* **Máximo:** 0.44474


**Estadísticas del Modelo:**

* **R-cuadrado múltiple:** 0.0104, lo que indica que solo el 1.04% de la variabilidad en la diferencia logarítmica de la temperatura media es explicada por el modelo.
* **R-cuadrado ajustado:** 0.004946, que es ligeramente inferior al R-cuadrado múltiple.
* **F-estadístico:** 1.907 con un valor p de 0.05521, lo que sugiere que el modelo en su conjunto no es significativo al nivel del 5%, pero está cerca de serlo.


* Mes: Es la única variable que parece tener un efecto significativo en la diferencia logarítmica de la temperatura media.
* Ajuste del Modelo: El modelo actual explica muy poca variabilidad en la serie temporal de la temperatura media (1.04%). Esto puede indicar que hay otros factores no incluidos en el modelo que son importantes.
* Prueba de Normalidad: Realizar la prueba de normalidad de los residuos para verificar su distribución.
* Análisis de Residuos: Examinar los residuos del modelo para verificar la adecuación del modelo.



## Diagnóstico del Modelo

**Gráfico de Residuos:**

```{r}
# Diagnóstico del Modelo
# Verificar los residuos del modelo
# Gráfico de residuos
ggplot(data, aes(x = date, y = residuals(model))) +
  geom_line() +
  labs(title = "Residuos del Modelo de Temperatura", y = "Residuos", x = "Fecha")
```

El gráfico de residuos muestra las diferencias entre los valores predichos por el modelo y los valores observados en la serie temporal de la temperatura media. Observaciones clave:

* **Comportamiento de los Residuos:**

* Los residuos parecen tener una media alrededor de cero, lo cual es bueno y esperado.
* Sin embargo, la variabilidad de los residuos no es constante a lo largo del tiempo. Este fenómeno, conocido como heterocedasticidad, puede indicar que el modelo no captura completamente la estructura de los datos.

* **Patrones en los Residuos:**

* Algunos períodos muestran residuos más grandes, especialmente al inicio y en ciertos picos alrededor de los años 2014 y 2015. Esto puede sugerir que hay factores adicionales no considerados en el modelo que afectan la temperatura en estos períodos.

**Prueba de normalidad de los residuos**

```{r}

shapiro_test_result <- shapiro.test(residuals(model))
print(shapiro_test_result)
```

**Resultados:**

* **W = 0.94823:** Este es el estadístico de la prueba de Shapiro-Wilk. Un valor cercano a 1 indica que los datos son aproximadamente normales, mientras que valores menores sugieren desviaciones de la normalidad.
* **p-value < 2.2e-16:** El p-valor es extremadamente pequeño, significativamente menor que cualquier nivel típico de significancia




## Previsión Futura

```{r}
# Previsión Futura
# Generar un nuevo conjunto de datos para las predicciones futuras
future_dates <- seq(max(data$date) + 1, by = "day", length.out = 10)
new_data <- data.frame(
  date = future_dates,
  day_of_week = factor(wday(future_dates, label = TRUE)),
  meantemp_diff = NA,  # Placeholder, no se usa en el modelo de predicción
  year = year(future_dates),
  month = month(future_dates)
)

# Predecir usando el modelo ajustado
prediction <- predict(model, newdata = new_data)

# Visualizar las predicciones
plot(future_dates, prediction, type = "l", col = "blue", xlab = "Date", ylab = "Predicted Mean Temperature",
     main = "Forecast of Mean Temperature")
lines(data$date, data$meantemp, col = "red")  # Añadir los datos originales para comparar

```


* **Tendencia General:**

La predicción muestra una variabilidad en la temperatura media para los próximos 10 días.
Se observa un descenso inicial en la temperatura, seguido de un aumento significativo hacia el final del período de predicción.

* **Amplitud de Predicción:**

La amplitud de la predicción varía considerablemente, lo que podría sugerir una alta volatilidad en los datos predichos.




## SARIMA

Dados los resultados aplicaremos SARIMA

```{r}
# Cargar las librerías necesarias
library(forecast)
library(ggplot2)

# Ajuste del modelo SARIMA utilizando auto.arima para identificar el mejor modelo
sarima_model <- auto.arima(data$meantemp_log, seasonal = TRUE)

# Resumen del modelo ajustado
summary(sarima_model)

# Diagnóstico de residuos del modelo SARIMA
checkresiduals(sarima_model)

```
El gráfico muestra los residuos del modelo ARIMA ajustado, indicando que el modelo ARIMA(4,1,3) fue seleccionado como el mejor ajuste para la serie temporal

**Residuos del Modelo**
El gráfico de los residuos muestra que, en general, los residuos parecen ser ruido blanco, lo cual es una buena indicación de que el modelo está capturando bien las estructuras en los datos. Sin embargo, algunos picos en los residuos sugieren que podría haber eventos extremos o outliers no capturados por el modelo.

**Prueba de Ljung-Box**
La prueba de Ljung-Box se utiliza para verificar la autocorrelación en los residuos del modelo de series temporales. En este caso, el p-valor de 0.1566 indica que no podemos rechazar la hipótesis nula de que los residuos no están correlacionados. 

```{r}
# Predicción futura con el modelo SARIMA
sarima_forecast <- forecast(sarima_model, h = 10)  # Predice los próximos 10 días

# Crear un data frame para las fechas futuras
future_dates <- seq(max(data$date) + 1, by = "day", length.out = 10)
future_data <- data.frame(date = future_dates, meantemp_log = sarima_forecast$mean)

# Visualización de las predicciones
ggplot() +
  geom_line(data = data, aes(x = date, y = meantemp_log), color = "red") +
  geom_line(data = future_data, aes(x = date, y = meantemp_log), color = "blue") +
  labs(title = "Predicción de Temperatura Media con Modelo SARIMA",
       x = "Fecha", y = "Temperatura Media Logarítmica")


```


